<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Himalayan Cat: The Island Dream</title>
    <style>
        :root { --main-color: #f1c40f; }
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Cairo', sans-serif; touch-action: none; }
        #game-container { position: relative; width: 100vw; height: 100vh; }
        canvas { display: block; background: linear-gradient(#001d3d, #000); }
        
        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… */
        #hud { position: absolute; top: 20px; width: 100%; display: flex; justify-content: space-around; color: #fff; z-index: 10; pointer-events: none; }
        .stat-box { background: rgba(0,0,0,0.6); padding: 10px 20px; border-radius: 15px; border: 2px solid var(--main-color); box-shadow: 0 0 15px var(--main-color); }
        
        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        #overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; color: #fff; text-align: center; }
        .logo { font-size: 3em; color: var(--main-color); text-shadow: 0 0 20px #fff; margin-bottom: 20px; }
        .btn-start { padding: 20px 60px; font-size: 1.5em; background: #27ae60; color: white; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 8px 0 #1e8449; transition: 0.1s; }
        .btn-start:active { transform: translateY(4px); box-shadow: none; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="hud">
        <div class="stat-box">ğŸŸ Ø§Ù„Ø³Ù…Ùƒ: <span id="fish-val">0</span></div>
        <div id="lvl-tag" class="stat-box" style="border-color: #3498db;">Ø§Ù„Ù…Ø±Ø­Ù„Ø©: 1</div>
        <div class="stat-box">ğŸš© Ø§Ù„Ù…Ø³Ø§ÙØ©: <span id="dist-val">1000</span>m</div>
    </div>

    <div id="overlay">
        <div class="logo">Ù…ØºØ§Ù…Ø±Ø© Ø§Ù„Ø¬Ø²ÙŠØ±Ø© ğŸï¸</div>
        <p style="font-size: 1.2em; max-width: 80%;">Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù‚Ø·Ø© "Ù‡Ù…Ù„Ø§ÙŠØ§" Ù„Ø¬Ù…Ø¹ Ø§Ù„Ø«Ø±ÙˆØ© ÙˆØ¨Ù†Ø§Ø¡ Ø¬Ø²ÙŠØ±Ø© Ø§Ù„Ø£Ù…Ù„!</p>
        <button class="btn-start" onclick="initGame()">Ø¥Ø¨Ø¯Ø£ Ø§Ù„Ù…ØºØ§Ù…Ø±Ø© ğŸš€</button>
    </div>

    <canvas id="canvas"></canvas>
</div>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    
    // Ø±ÙˆØ§Ø¨Ø· ØµÙˆØ± Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø© (ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… PNG Ø´ÙØ§ÙØ©)
    const assets = {
        cat: 'https://i.ibb.co/LzqM8Pz/himalayan-cat.png', 
        fish: 'https://cdn-icons-png.flaticon.com/128/603/603310.png',
        monster: 'https://i.ibb.co/D7V6BfH/wolf-real.png'
    };

    const imgNodes = {};
    Object.keys(assets).forEach(key => {
        imgNodes[key] = new Image();
        imgNodes[key].src = assets[key];
    });

    let state = {
        active: false,
        fish: 0,
        level: 0,
        dist: 1000,
        colors: ["#f1c40f", "#3498db", "#2ecc71", "#111111", "#8b4513", "#800000", "#4b0082", "#2f4f4f", "#ff4500", "#556b2f"]
    };

    let player = { x: 100, y: 0, v: 0, w: 80, h: 60 };
    let obstacles = [];
    let food = [];
    let monster = { x: -250, y: 0 };

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    function initGame() {
        document.getElementById('overlay').style.display = 'none';
        state.active = true;
        state.dist = 1000;
        player.y = canvas.height / 2;
        player.v = 0;
        obstacles = [];
        food = [];
        monster.x = -250;
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        if (state.active) {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†Ø·Ù‚
            player.v += 0.5;
            player.y += player.v;
            state.dist -= 0.5;
            monster.y += (player.y - monster.y) * 0.05;
            monster.x = Math.min(player.x - 150, monster.x + 0.4);

            // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚ (Ø§Ù„Ø­ÙˆØ§Ø¬Ø²)
            if (obstacles.length === 0 || obstacles[obstacles.length-1].x < canvas.width - 400) {
                let gap = 300;
                let pos = Math.random() * (canvas.height - gap - 100) + 50;
                obstacles.push({ x: canvas.width, y: pos, g: gap });
                food.push({ x: canvas.width + 150, y: pos + gap/2 });
            }

            // Ø±Ø³Ù… ÙˆØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø­ÙˆØ§Ø¬Ø²
            obstacles.forEach((ob, i) => {
                ob.x -= 7;
                ctx.fillStyle = state.colors[state.level % 10];
                ctx.fillRect(ob.x, 0, 80, ob.y);
                ctx.fillRect(ob.x, ob.y + ob.g, 80, canvas.height);
                
                // ØªØµØ§Ø¯Ù… Ø§Ù„Ø­ÙˆØ§Ø¬Ø²
                if (player.x + 60 > ob.x && player.x < ob.x + 80 && (player.y < ob.y || player.y + 40 > ob.y + ob.g)) state.active = false;
                if (ob.x < -100) obstacles.splice(i, 1);
            });

            // Ø±Ø³Ù… ÙˆØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø³Ù…Ùƒ
            food.forEach((f, i) => {
                f.x -= 7;
                ctx.drawImage(imgNodes.fish, f.x, f.y, 50, 40);
                if (Math.hypot(player.x - f.x, player.y - f.y) < 50) {
                    state.fish += 100;
                    food.splice(i, 1);
                    document.getElementById('fish-val').innerText = state.fish;
                }
            });

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            document.getElementById('dist-val').innerText = Math.max(0, Math.floor(state.dist));
            if (state.dist <= 0) {
                state.level++;
                state.active = false;
                document.getElementById('overlay').style.display = 'flex';
                document.querySelector('.logo').innerText = "ØªÙ…Øª Ø§Ù„Ù…Ø±Ø­Ù„Ø©! ğŸï¸";
            }

            if (player.y > canvas.height || player.y < -100 || player.x < monster.x + 100) state.active = false;
        }

        // Ø±Ø³Ù… Ø§Ù„ÙˆØ­Ø´ ÙˆØ§Ù„Ù‚Ø·Ø©
        ctx.drawImage(imgNodes.monster, monster.x, monster.y, 180, 150);
        ctx.drawImage(imgNodes.cat, player.x, player.y, player.w, player.h);

        if (!state.active && state.dist > 0) {
            document.getElementById('overlay').style.display = 'flex';
            document.querySelector('.logo').innerText = "Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰! ğŸ™€";
        }

        requestAnimationFrame(draw);
    }

    const jump = () => { if(state.active) player.v = -10; };
    window.addEventListener('mousedown', jump);
    window.addEventListener('touchstart', (e) => { e.preventDefault(); jump(); }, {passive: false});

    draw();
</script>
</body>
</html>